{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jrbel\\\\Documents\\\\lnurl-auth\\\\client\\\\src\\\\components\\\\paywall\\\\Paywall.js\",\n    _s = $RefreshSig$();\n\nimport \"./Paywall.css\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { requestProvider } from \"webln\";\nimport axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Paywall() {\n  _s();\n\n  const [invoice, setInvoice] = useState(\"\");\n  const [payment, setPayment] = useState(\"\");\n  let navigate = useNavigate();\n  const {\n    state\n  } = useLocation();\n  useEffect(() => {\n    fetchInvoice();\n  }, []);\n  useEffect(() => {\n    if (payment !== \"\") {\n      localStorage.setItem(\"paid\", true);\n      const post = state.paywallPost;\n      navigate(`/post/${post.id}`, {\n        state: {\n          post\n        }\n      });\n    }\n  }, [payment, navigate, state]);\n\n  const navigateHome = () => {\n    navigate(\"/\");\n  };\n\n  const managePayment = async () => {\n    const webln = await requestProvider();\n    const payment = await webln.sendPayment(invoice);\n    setPayment(payment);\n  };\n\n  const fetchInvoice = async () => {\n    const apiKey = \"bc450881c4db44b69db6947179ac427d\";\n    const data = `{\"out\": false, \"amount\": 5, \"memo\": \"Lightning rocks\", \"unit\": \"sat\", \"webhook\": \"\", \"internal\": false}`;\n    const getInvoice = {\n      method: \"POST\",\n      headers: {\n        \"content-type\": \"application/json\",\n        \"X-Api-Key\": apiKey\n      },\n      data: data,\n      url: \"https://legend.lnbits.com/api/v1/payments\"\n    };\n    await axios.request(getInvoice).then(async function (res) {\n      setInvoice(res.data.payment_request);\n    }).catch(function (err) {\n      console.log(\"error = \" + err);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"paywallPage\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"paywallContainer\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"paywallTitle\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Paywall\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"paywallText\",\n        children: \"This is premium content. You need to pay 5 sats to read this blog post.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"buttonLayout\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"buttonStyle\",\n        onClick: navigateHome,\n        children: \"Go back\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"buttonStyle\",\n        onClick: managePayment,\n        children: \"Pay\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Paywall, \"JaOm3oD397BNWbZiGqkffMRd6ro=\", false, function () {\n  return [useNavigate, useLocation];\n});\n\n_c = Paywall;\nexport default Paywall;\n\nvar _c;\n\n$RefreshReg$(_c, \"Paywall\");","map":{"version":3,"names":["useNavigate","useLocation","requestProvider","axios","useEffect","useState","Paywall","invoice","setInvoice","payment","setPayment","navigate","state","fetchInvoice","localStorage","setItem","post","paywallPost","id","navigateHome","managePayment","webln","sendPayment","apiKey","data","getInvoice","method","headers","url","request","then","res","payment_request","catch","err","console","log"],"sources":["C:/Users/jrbel/Documents/lnurl-auth/client/src/components/paywall/Paywall.js"],"sourcesContent":["import \"./Paywall.css\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport { requestProvider } from \"webln\";\r\nimport axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nfunction Paywall() {\r\n  const [invoice, setInvoice] = useState(\"\");\r\n  const [payment, setPayment] = useState(\"\");\r\n  let navigate = useNavigate();\r\n\r\n  const { state } = useLocation();\r\n\r\n\r\n  useEffect(() => {\r\n    fetchInvoice();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (payment !== \"\") {\r\n      localStorage.setItem(\"paid\", true);\r\n      const post = state.paywallPost;\r\n      navigate(`/post/${post.id}`, {\r\n        state: {\r\n          post,\r\n        },\r\n      });\r\n    }\r\n  }, [payment, navigate, state]);\r\n\r\n  const navigateHome = () => {\r\n    navigate(\"/\");\r\n  };\r\n\r\n  const managePayment = async () => {\r\n    const webln = await requestProvider();\r\n    const payment = await webln.sendPayment(invoice);\r\n    setPayment(payment);\r\n  };\r\n\r\n  const fetchInvoice = async () => {\r\n    const apiKey = \"bc450881c4db44b69db6947179ac427d\";\r\n    const data = `{\"out\": false, \"amount\": 5, \"memo\": \"Lightning rocks\", \"unit\": \"sat\", \"webhook\": \"\", \"internal\": false}`;\r\n    const getInvoice = {\r\n      method: \"POST\",\r\n      headers: { \"content-type\": \"application/json\", \"X-Api-Key\": apiKey },\r\n      data: data,\r\n      url: \"https://legend.lnbits.com/api/v1/payments\",\r\n    };\r\n    await axios\r\n      .request(getInvoice)\r\n      .then(async function (res) {\r\n        setInvoice(res.data.payment_request);\r\n      })\r\n      .catch(function (err) {\r\n        console.log(\"error = \" + err);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className=\"paywallPage\">\r\n      <div className=\"paywallContainer\">\r\n        <div className=\"paywallTitle\">\r\n          <h1>Paywall</h1>\r\n        </div>\r\n        <div className=\"paywallText\">\r\n          This is premium content. You need to pay 5 sats to read this blog\r\n          post.\r\n        </div>\r\n      </div>\r\n      <div className=\"buttonLayout\">\r\n        <button className=\"buttonStyle\" onClick={navigateHome}>\r\n          Go back\r\n        </button>\r\n        <button className=\"buttonStyle\" onClick={managePayment}>\r\n          Pay\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Paywall;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}